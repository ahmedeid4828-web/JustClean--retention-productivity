<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JustClean - Employee Utilization</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
:root {
    --purple: #6f42c1;
    --light-purple: #e2d9f3;
    --white: #ffffff;
    --red: #f8d7da;
    --yellow: #fff3cd;
    --green: #d4edda;
}
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--white);
    color: #333;
    padding-bottom: 50px;
}
.container { max-width: 1200px; margin-top: 20px; }
.card { box-shadow: 0 4px 10px rgba(111,66,193,0.1); border-radius: 12px; margin-bottom: 20px; }
.card-header.bg-purple { background-color: var(--purple); color: var(--white); }
#resultDiv {
    margin-top: 20px;
    margin-bottom: 30px;
    padding: 12px;
    border-radius: 10px;
    font-weight: bold;
    text-align: center;
}
.table thead { background-color: var(--purple); color: white; }
.table-striped tbody tr:nth-of-type(odd) { background-color: var(--light-purple); }
.table td, .table th { padding: 12px 8px; }
.btn-purple { background-color: var(--purple); border-color: var(--purple); color: #fff; }
.btn-purple:hover { background-color: #5a32a3; }
</style>
</head>
<body>
<div class="container">

    <div class="card text-center">
        <!-- Logo -->
        <div class="text-center mb-3 mt-3">
            <img src="YOUR_LOGO_URL_HERE" alt="JustClean Logo" style="max-width: 150px;">
        </div>

        <div class="card-header bg-purple text-center">
            <h2><i class="fas fa-users"></i> Employee Utilization Tracker</h2>
            <p class="mb-0">Upload CSV with Name, Hours Worked, Break Hours, Call Duration, Calls Count</p>
        </div>

        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Employee Name</label>
                    <input type="text" class="form-control" id="employeeName" placeholder="e.g., Mariam">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Hours Worked</label>
                    <input type="number" class="form-control" id="hoursWorked" step="0.25" min="0" placeholder="e.g., 8">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Break Hours</label>
                    <input type="number" class="form-control" id="breakHours" step="0.25" min="0" placeholder="e.g., 1">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-purple w-100" id="calculateBtn"><i class="fas fa-calculator"></i> Calculate</button>
                </div>
            </div>

            <div id="resultDiv" class="alert alert-info" style="display:none;">
                <strong>Net Hours: </strong><span id="netHours"></span>
            </div>

            <div class="row g-3 mt-2">
                <div class="col-md-6">
                    <input type="file" class="form-control" id="csvFile" accept=".csv">
                </div>
                <div class="col-md-6">
                    <button class="btn btn-purple w-100" id="uploadBtn"><i class="fas fa-upload"></i> Upload & Analyze CSV</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Table Card -->
    <div class="card" id="dataTable" style="display:none;">
        <div class="card-header bg-purple d-flex justify-content-between align-items-center">
            <h5><i class="fas fa-table"></i> Employees Metrics</h5>
            <div>
                <button class="btn btn-light btn-sm" id="exportBtn"><i class="fas fa-download"></i> Export CSV</button>
                <button class="btn btn-danger btn-sm" id="clearAllBtn"><i class="fas fa-trash"></i> Clear All</button>
            </div>
        </div>
        <div class="card-body p-0">
            <table class="table table-striped mb-0">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Hours Worked</th>
                        <th>Break Hours</th>
                        <th>Net Hours</th>
                        <th>Total Call Duration</th>
                        <th>Total Calls</th>
                        <th>Utilization %</th>
                        <th>Occupation %</th>
                        <th>Date & Time</th>
                    </tr>
                </thead>
                <tbody id="dataTableBody"></tbody>
            </table>
        </div>
    </div>

</div>

<script>
let employeeData = JSON.parse(localStorage.getItem('employeeData')) || [];
function displayTable(){
    const tbody = document.getElementById('dataTableBody');
    tbody.innerHTML = '';
    employeeData.forEach(emp=>{
        const row = document.createElement('tr');
        let utilClass='';
        if(emp.utilization<50) utilClass='bg-danger text-white';
        else if(emp.utilization<75) utilClass='bg-warning';
        else utilClass='bg-success text-white';
        row.innerHTML=`
            <td>${emp.name}</td>
            <td>${emp.hoursWorked}</td>
            <td>${emp.breakHours}</td>
            <td>${emp.netHours.toFixed(2)}</td>
            <td>${emp.totalDuration.toFixed(2)}</td>
            <td>${emp.totalCalls}</td>
            <td class="${utilClass}">${emp.utilization.toFixed(2)}</td>
            <td>${emp.occupation.toFixed(2)}</td>
            <td>${emp.timestamp}</td>
        `;
        tbody.appendChild(row);
    });
}
function showResult(netHours){document.getElementById('netHours').textContent=netHours.toFixed(2); document.getElementById('resultDiv').style.display='block';}
function hideResult(){document.getElementById('resultDiv').style.display='none';}

document.getElementById('calculateBtn').addEventListener('click',()=>{
    const name=document.getElementById('employeeName').value.trim();
    const hoursWorked=parseFloat(document.getElementById('hoursWorked').value);
    const breakHours=parseFloat(document.getElementById('breakHours').value);
    if(!name||isNaN(hoursWorked)||isNaN(breakHours)||breakHours>hoursWorked){alert('Invalid input'); return;}
    showResult(hoursWorked-breakHours);
});

document.getElementById('uploadBtn').addEventListener('click',()=>{
    const fileInput=document.getElementById('csvFile');
    const file=fileInput.files[0];
    if(!file){alert('Select CSV first'); return;}
    const reader=new FileReader();
    reader.onload=function(e){
        const text=e.target.result;
        processCSV(text);
    };
    reader.readAsText(file);
});

function processCSV(csv){
    const lines=csv.split(/\r?\n/).filter(l=>l.trim()!='');
    let now=new Date().toLocaleString();
    lines.forEach((line,i)=>{
        if(i===0) return;
        const cols=line.split(',');
        if(cols.length<5) return;
        const name=cols[0].trim();
        const hoursWorked=parseFloat(cols[1]);
        const breakHours=parseFloat(cols[2]);
        const callDuration=parseFloat(cols[3]);
        const callsCount=parseInt(cols[4]);
        const netHours=hoursWorked-breakHours;
        const utilization=netHours>0?(callDuration/netHours)*100:0;
        const occupation=hoursWorked>0?(callDuration/hoursWorked)*100:0;
        employeeData.unshift({name,hoursWorked,breakHours,netHours,totalDuration:callDuration,totalCalls:callsCount,utilization,occupation,timestamp:now});
    });
    localStorage.setItem('employeeData',JSON.stringify(employeeData));
    document.getElementById('dataTable').style.display='block';
    displayTable();
    alert('CSV processed successfully');
}
</script>
</body>
</html>

